<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OT-SCADA Simulation Platform</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <!-- Leaflet CSS for OpenStreetMap -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>ðŸ”’ CLASSIFIED - Critical Infrastructure Control System</h1>
                <div class="header-controls">
                    <span class="status-indicator" id="connection-status">Connected</span>
                    <button class="btn btn-secondary" onclick="window.location.href='/firewall-login'">Firewall Login</button>
                    <button class="btn btn-secondary" onclick="showFirewall()">Firewall</button>
                    <button class="btn btn-secondary" onclick="showMap()">Network Map</button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Firewall Interface -->
            <div id="firewall-panel" class="panel active">
                <div class="panel-header">
                    <h2>Palo Alto NextGen Firewall</h2>
                    <div class="panel-controls">
                        <button class="btn btn-primary" onclick="addFirewallRule()">Add Rule</button>
                        <label class="toggle">
                            <input type="checkbox" id="ips-toggle" checked onchange="toggleIPS()">
                            <span>IPS Enabled</span>
                        </label>
                    </div>
                </div>
                
                <div class="firewall-content">
                    <!-- Firewall Status -->
                    <div class="status-card">
                        <h3>Firewall Status</h3>
                        <div id="firewall-status" class="status-info"></div>
                    </div>

                    <!-- Firewall Rules -->
                    <div class="rules-section">
                        <h3>Firewall Rules</h3>
                        <table class="rules-table" id="firewall-rules-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Source</th>
                                    <th>Destination</th>
                                    <th>Service</th>
                                    <th>Action</th>
                                    <th>Enabled</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="firewall-rules-body">
                            </tbody>
                        </table>
                    </div>

                    <!-- Firewall Logs -->
                    <div class="logs-section">
                        <h3>Firewall Logs</h3>
                        <div class="logs-container" id="firewall-logs"></div>
                    </div>
                </div>
            </div>

            <!-- SCADA Portal -->
            <div id="scada-panel" class="panel">
                <div class="panel-header">
                    <h2>SCADA Control Portal</h2>
                    <div class="panel-controls">
                        <span id="scada-access-status" class="access-status">Access Denied</span>
                    </div>
                </div>

                <div class="scada-content">
                    <!-- Grid Status -->
                    <div class="grid-status-card">
                        <h3>Power Grid Status</h3>
                        <div id="grid-status" class="grid-metrics"></div>
                    </div>

                    <!-- SCADA Devices -->
                    <div class="devices-section">
                        <h3>SCADA Devices</h3>
                        <div id="scada-devices" class="devices-grid"></div>
                    </div>

                    <!-- Device Control Panel -->
                    <div id="device-control-panel" class="control-panel" style="display: none;">
                        <h3>Device Control</h3>
                        <div id="device-control-content"></div>
                    </div>
                </div>
            </div>

            <!-- Network Map -->
            <div id="map-panel" class="panel">
                <div class="panel-header">
                    <h2>Geographic Map - India (Jammu & Kashmir Region)</h2>
                    <div class="panel-controls">
                        <span style="color: #888; font-size: 0.9rem;">OpenStreetMap View - Power Grid Stations</span>
                    </div>
                </div>
                <div class="map-container">
                    <!-- Leaflet Map Container -->
                    <div id="network-map" style="height: 800px; width: 100%; z-index: 1;"></div>
                </div>
            </div>
        </main>

        <!-- Device Detail Modal -->
        <div id="device-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeDeviceModal()">&times;</span>
                <div id="device-modal-content"></div>
            </div>
        </div>

        <!-- Add Rule Modal -->
        <div id="rule-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeRuleModal()">&times;</span>
                <h2>Add Firewall Rule</h2>
                <form id="rule-form" onsubmit="saveRule(event)">
                    <div class="form-group">
                        <label>Rule Name:</label>
                        <input type="text" id="rule-name" required>
                    </div>
                    <div class="form-group">
                        <label>Source:</label>
                        <input type="text" id="rule-source" placeholder="e.g., any, 192.168.1.0/24" required>
                    </div>
                    <div class="form-group">
                        <label>Destination:</label>
                        <input type="text" id="rule-destination" placeholder="e.g., 10.0.0.0/8" required>
                    </div>
                    <div class="form-group">
                        <label>Service:</label>
                        <select id="rule-service" required>
                            <option value="any">Any</option>
                            <option value="http">HTTP</option>
                            <option value="https">HTTPS</option>
                            <option value="ssh">SSH</option>
                            <option value="scada">SCADA</option>
                            <option value="modbus">Modbus</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Action:</label>
                        <select id="rule-action" required>
                            <option value="allow">Allow</option>
                            <option value="deny">Deny</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="rule-enabled" checked>
                            Enabled
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Rule</button>
                </form>
            </div>
        </div>
    </div>

    <script src="/static/js/main.js"></script>
</body>
</html>

